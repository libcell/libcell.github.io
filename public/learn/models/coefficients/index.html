<!DOCTYPE html>
<html>
<head>
<!DOCTYPE html>
<html lang="en-us">



<link rel="stylesheet" href="/css/fonts.css">
<link rel="stylesheet" href="/css/main-site.css">
<link rel="stylesheet" href="/css/fa5-all.css">
<style type="text/css">
    body {
	background-color: #ffffff;
	color: #404040
}

/* Links */

a {
  color: #CA225E;
}

a:hover {
  color: #cc3168;
}

/* Landing page content bands */

#homeContent .band.first {
  background-color: #ffffff
}

#homeContent .band.second {
  background-color: #fcfcfc
}

#homeContent .band.third {
  background-color: #ffffff
}

/* Top navigation bar menu */

#rStudioHeader {
  background-color: #ffffff;
  color: black;
}

#rStudioHeader .productName {
  color: #CA225E
}

#rStudioHeader .productName:hover {
  color: #00000075
}

#rStudioHeader #menu .menuItem.a {
  background-color: #75aadb;
  color: black;
}

#rStudioHeader #menu .menuItem:hover {
  background-color: white;
  color: #CA225E;
}

#rStudioHeader #menu .menuItem.current {
  background-color: #fcfcfc;
  color: #CA225E;
  text-decoration: none;
}

/* Footer */

#rStudioFooter.band {
  background-color: #CA225E40;
}

#rStudioFooter .bandContent #copyright {
  color: #CA225E;
}

/* Tables */

table tbody tr:nth-child(even){
  background-color: #fcfcfc;
}

table tbody tr:nth-child(odd){
  background-color: #1a162d10;
}

.latest {
  border-top: .5em solid <no value>;
}
</style>

  <link rel="stylesheet" href="/css/tm.css">




<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="apple-mobile-web-app-capable" content="yes" />

<meta name="og:image" content="https://www.tidymodels.org/images/feature_summary_large_image.jpg" >

  <meta property="twitter:card" content="summary_large_image">

<meta name="twitter:image" content="https://www.tidymodels.org/images/feature_summary_large_image.jpg" ><meta name="generator" content="Hugo 0.96.0" />

<meta property="og:type" content="website"><title>Learn - Working with model coefficients</title>
    <meta property="og:title" content="Learn - Working with model coefficients">
    
    
    
    
    <meta property="description" content="Create models that use coefficients, extract them from fitted models, and visualize them.
">
    <meta property="og:description" content="Create models that use coefficients, extract them from fitted models, and visualize them.
">



<link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png" />
<link rel="manifest" href="/images/favicons/site.webmanifest" />
<link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" />
<link rel="shortcut icon" href="/images/favicons/favicon.ico" />
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" href="/images/favicons/browserconfig.xml" >



<script type="text/javascript" src="/js/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="/js/site.js"></script>


  <script type="text/javascript" src="/js/tm.js"></script>


<link rel="icon" href="/images/favicon.ico" />


<script defer data-domain="tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>



  <body>
    <div id="appTidyverseSite" class="shrinkHeader alwaysShrinkHeader">
      <div id="main">
        
        <div id="rStudioHeader">
          <div class="band">
            <div class="innards bandContent">
              <div>
                <a class="productName" href="/">Tidymodels</a>
                
              </div>
              <div id="menu">
  <div id="menuToggler"></div>
  <div id="menuItems" class="">
    
    
      
      
      
    <a class="menuItem " href="/packages/">Packages</a>
    
      
      
      
    <a class="menuItem " href="/start/">Get Started</a>
    
      
      
      
    <a class="menuItem current" href="/learn/">Learn</a>
    
      
      
      
    <a class="menuItem " href="/help/">Help</a>
    
      
      
      
    <a class="menuItem " href="/contribute/">Contribute</a>
    
      
      
      
    <a class="menuItem " href="/find/"><i class="fas fa-search fa-lg"></i> </a>
    
      
      
      
    <a class="menuItem " href="https://github.com/tidymodels/"><i class="fab fa-github fa-lg"></i></a>
    
  </div>
</div>

            </div>
          </div>
        </div>
</head>
<body>


 




<div class="band padForHeader pushFooter">
  <div class="bandContent">
    <div class="full splitColumns withMobileMargins">
      <div class="column75">
        
        <div class="section">
          <div class="sectionTitle">
            <a href="/learn/">
              <i class="fas fa-chevron-left"></i>&nbsp;Back to Learn
            </a>
          </div>
        </div>

      <h1 class="article-title">Working with model coefficients</h1>

      
      <div class="article-header">
        </div>
        

      
      
      
      
        </p>
      
        
      <div class="learning-objective-container">
        <h2 class="learning-objective">Learning objective</h2>
        <p class="single-learning-objective-text">Create models that use coefficients, extract them from fitted models, and visualize them.</p>
      </div>
      

      <div class="article-content">
      <h2 id="introduction">Introduction</h2>
<p>There are many types of statistical models with diverse kinds of structure. Some models have coefficients (a.k.a. weights) for each term in the model. Familiar examples of such models are linear or logistic regression, but more complex models (e.g. neural networks, MARS) can also have model coefficients. When we work with models that use weights or coefficients, we often want to examine the estimated coefficients.</p>
<p>This article describes how to retrieve the estimated coefficients from models fit using tidymodels. To use the code in this article, you will need to install the following packages: glmnet and tidymodels.</p>
<h2 id="linear-regression">Linear regression</h2>
<p>Let&rsquo;s start with a linear regression model:</p>
<p><code>$$\hat{y} = \hat{\beta}_0 + \hat{\beta}_1x_1 + \ldots + \hat{\beta}_px_p$$</code></p>
<p>The <code>\(\beta\)</code> values are the coefficients and the <code>\(x_j\)</code> are model predictors, or features.</p>
<p>Let&rsquo;s use the <a href="https://bookdown.org/max/FES/chicago-intro.html">Chicago train data</a> where we predict the ridership at the Clark and Lake station (column name: <code>ridership</code>) with the previous ridership data 14 days prior at three of the stations.</p>
<p>The data are in the modeldata package:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">library</span>(tidymodels)
</span></span><span style="display:flex;"><span><span style="color:#00f">tidymodels_prefer</span>()
</span></span><span style="display:flex;"><span><span style="color:#00f">theme_set</span>(<span style="color:#00f">theme_bw</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">data</span>(Chicago)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Chicago <span style="color:#666">&lt;-</span> Chicago <span style="color:#666">%&gt;%</span> <span style="color:#00f">select</span>(ridership, Clark_Lake, Austin, Harlem)
</span></span></code></pre></div><h3 id="a-single-model">A single model</h3>
<p>Let&rsquo;s start by fitting only a single parsnip model object. We&rsquo;ll create a model specification using <code>linear_reg()</code>.</p>
<div class="note">The default engine is <code>&quot;lm&quot;</code> so no call to <code>set_engine()</code> is required.</div>
<p>The <code>fit()</code> function estimates the model coefficients, given a formula and data set.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_spec <span style="color:#666">&lt;-</span> <span style="color:#00f">linear_reg</span>()
</span></span><span style="display:flex;"><span>lm_fit <span style="color:#666">&lt;-</span> <span style="color:#00f">fit</span>(lm_spec, ridership <span style="color:#666">~</span> ., data <span style="color:#666">=</span> Chicago)
</span></span><span style="display:flex;"><span>lm_fit
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; parsnip model object</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Call:</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; stats::lm(formula = ridership ~ ., data = data)</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Coefficients:</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; (Intercept)   Clark_Lake       Austin       Harlem  </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;       1.678        0.904        0.612       -0.555</span>
</span></span></code></pre></div><p>The best way to retrieve the fitted parameters is to use the <code>tidy()</code> method. This function, in the broom package, returns the coefficients and their associated statistics in a data frame with standardized column names:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">tidy</span>(lm_fit)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 4 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   term        estimate std.error statistic   p.value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 (Intercept)    1.68     0.156      10.7  1.11e- 26</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 Clark_Lake     0.904    0.0280     32.3  5.14e-210</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 Austin         0.612    0.320       1.91 5.59e-  2</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 Harlem        -0.555    0.165      -3.36 7.85e-  4</span>
</span></span></code></pre></div><p>We&rsquo;ll use this function in subsequent sections.</p>
<h3 id="resampled-or-tuned-models">Resampled or tuned models</h3>
<p>The tidymodels framework emphasizes the use of resampling methods to evaluate and characterize how well a model works. While time series resampling methods are appropriate for these data, we can also use the <a href="https://www.tmwr.org/resampling.html#bootstrap">bootstrap</a> to resample the data. This is a standard resampling approach when evaluating the uncertainty in statistical estimates.</p>
<p>We&rsquo;ll use five bootstrap resamples of the data to simplify the plots and output (normally, we would use a larger number of resamples for more reliable estimates).</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">set.seed</span>(<span style="color:#666">123</span>)
</span></span><span style="display:flex;"><span>bt <span style="color:#666">&lt;-</span> <span style="color:#00f">bootstraps</span>(Chicago, times <span style="color:#666">=</span> <span style="color:#666">5</span>)
</span></span></code></pre></div><p>With resampling, we fit the same model to the different simulated versions of the data set produced by resampling. The tidymodels function <a href="https://www.tmwr.org/resampling.html#resampling-performance"><code>fit_resamples()</code></a> is the recommended approach for doing so.</p>
<div class="warning">The <code>fit_resamples()</code> function does not automatically save the model objects for each resample since these can be quite large and its main purpose is estimating performance. However, we can pass a function to <code>fit_resamples()</code> that <em>can</em> save the model object or any other aspect of the fit.</div>
<p>This function takes a single argument that represents the fitted <a href="https://www.tmwr.org/workflows.html">workflow object</a> (even if you don&rsquo;t give <code>fit_resamples()</code> a workflow).</p>
<p>From this, we can extract the model fit. There are two &ldquo;levels&rdquo; of model objects that are available:</p>
<ul>
<li>
<p>The parsnip model object, which wraps the underlying model object. We retrieve this using the <code>extract_fit_parsnip()</code> function.</p>
</li>
<li>
<p>The underlying model object (a.k.a. the engine fit) via the <code>extract_fit_engine()</code>.</p>
</li>
</ul>
<p>We&rsquo;ll use the latter option and then tidy this model object as we did in the previous section. Let&rsquo;s add this to the control function so that we can re-use it.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>get_lm_coefs <span style="color:#666">&lt;-</span> <span style="color:#00f">function</span>(x) {
</span></span><span style="display:flex;"><span>  x <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># get the lm model object</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">extract_fit_engine</span>() <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic"># transform its format</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">tidy</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>tidy_ctrl <span style="color:#666">&lt;-</span> <span style="color:#00f">control_grid</span>(extract <span style="color:#666">=</span> get_lm_coefs)
</span></span></code></pre></div><p>This argument is then passed to <code>fit_resamples()</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_res <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  lm_spec <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">fit_resamples</span>(ridership <span style="color:#666">~</span> ., resamples <span style="color:#666">=</span> bt, control <span style="color:#666">=</span> tidy_ctrl)
</span></span><span style="display:flex;"><span>lm_res
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # Resampling results</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # Bootstrap sampling </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 5 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   splits              id         .metrics         .notes           .extracts</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;list&gt;              &lt;chr&gt;      &lt;list&gt;           &lt;list&gt;           &lt;list&gt;   </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 &lt;split [5698/2076]&gt; Bootstrap1 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 &lt;split [5698/2098]&gt; Bootstrap2 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 &lt;split [5698/2064]&gt; Bootstrap3 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 &lt;split [5698/2082]&gt; Bootstrap4 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5 &lt;split [5698/2088]&gt; Bootstrap5 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;</span>
</span></span></code></pre></div><p>Note that there is a <code>.extracts</code> column in our resampling results. This object contains the output of our <code>get_lm_coefs()</code> function for each resample. The structure of the elements of this column is a little complex. Let&rsquo;s start by looking at the first element (which corresponds to the first resample):</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_res<span style="color:#666">$</span>.extracts[[1]]
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 × 2</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   .extracts        .config             </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;list&gt;           &lt;chr&gt;               </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span></code></pre></div><p>There is <em>another</em> column in this element called <code>.extracts</code> that has the results of the <code>tidy()</code> function call:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_res<span style="color:#666">$</span>.extracts[[1]]<span style="color:#666">$</span>.extracts[[1]]
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 4 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   term        estimate std.error statistic   p.value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 (Intercept)    1.40     0.157       8.90 7.23e- 19</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 Clark_Lake     0.842    0.0280     30.1  2.39e-184</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 Austin         1.46     0.320       4.54 5.70e-  6</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 Harlem        -0.637    0.163      -3.92 9.01e-  5</span>
</span></span></code></pre></div><p>These nested columns can be flattened via the tidyr <code>unnest()</code> function:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_res <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, .extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts) 
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 5 × 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   id         .extracts        .config             </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;      &lt;list&gt;           &lt;chr&gt;               </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 Bootstrap1 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 Bootstrap2 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 Bootstrap3 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 Bootstrap4 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5 Bootstrap5 &lt;tibble [4 × 5]&gt; Preprocessor1_Model1</span>
</span></span></code></pre></div><p>We still have a column of nested tibbles, so we can run the same command again to get the data into a more useful format:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_coefs <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  lm_res <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, .extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lm_coefs <span style="color:#666">%&gt;%</span> <span style="color:#00f">select</span>(id, term, estimate, p.value)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 20 × 4</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    id         term        estimate   p.value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  1 Bootstrap1 (Intercept)    1.40  7.23e- 19</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  2 Bootstrap1 Clark_Lake     0.842 2.39e-184</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  3 Bootstrap1 Austin         1.46  5.70e-  6</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  4 Bootstrap1 Harlem        -0.637 9.01e-  5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  5 Bootstrap2 (Intercept)    1.69  2.87e- 28</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  6 Bootstrap2 Clark_Lake     0.911 1.06e-219</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  7 Bootstrap2 Austin         0.595 5.93e-  2</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  8 Bootstrap2 Harlem        -0.580 3.88e-  4</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  9 Bootstrap3 (Intercept)    1.27  3.43e- 16</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 10 Bootstrap3 Clark_Lake     0.859 5.03e-194</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 11 Bootstrap3 Austin         1.09  6.77e-  4</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 12 Bootstrap3 Harlem        -0.470 4.34e-  3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 13 Bootstrap4 (Intercept)    1.95  2.91e- 34</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 14 Bootstrap4 Clark_Lake     0.974 1.47e-233</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 15 Bootstrap4 Austin        -0.116 7.21e-  1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 16 Bootstrap4 Harlem        -0.620 2.11e-  4</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 17 Bootstrap5 (Intercept)    1.87  1.98e- 33</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 18 Bootstrap5 Clark_Lake     0.901 1.16e-210</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 19 Bootstrap5 Austin         0.494 1.15e-  1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 20 Bootstrap5 Harlem        -0.512 1.73e-  3</span>
</span></span></code></pre></div><p>That&rsquo;s better! Now, let&rsquo;s plot the model coefficients for each resample:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>lm_coefs <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">filter</span>(term <span style="color:#666">!=</span> <span style="color:#ba2121">&#34;(Intercept)&#34;</span>) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">ggplot</span>(<span style="color:#00f">aes</span>(x <span style="color:#666">=</span> term, y <span style="color:#666">=</span> estimate, group <span style="color:#666">=</span> id, col <span style="color:#666">=</span> id)) <span style="color:#666">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_hline</span>(yintercept <span style="color:#666">=</span> <span style="color:#666">0</span>, lty <span style="color:#666">=</span> <span style="color:#666">3</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_line</span>(alpha <span style="color:#666">=</span> <span style="color:#666">0.3</span>, lwd <span style="color:#666">=</span> <span style="color:#666">1.2</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">labs</span>(y <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Coefficient&#34;</span>, x <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">NULL</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">theme</span>(legend.position <span style="color:#666">=</span> <span style="color:#ba2121">&#34;top&#34;</span>)
</span></span></code></pre></div><img src="figs/lm-plot-1.svg" width="672" />
<p>There seems to be a lot of uncertainty in the coefficient for the Austin station data, but less for the other two.</p>
<p>Looking at the code for unnesting the results, you may find the double-nesting structure excessive or cumbersome. However, the extraction functionality is flexible, and a simpler structure would prevent many use cases.</p>
<h2 id="more-complex-a-glmnet-model">More complex: a glmnet model</h2>
<p>The glmnet model can fit the same linear regression model structure shown above. It uses regularization (a.k.a penalization) to estimate the model parameters. This has the benefit of shrinking the coefficients towards zero, important in situations where there are strong correlations between predictors or if some feature selection is required. Both of these cases are true for our Chicago train data set.</p>
<p>There are two types of penalization that this model uses:</p>
<ul>
<li>
<p>Lasso (a.k.a. <code>\(L_1\)</code>) penalties can shrink the model terms so much that they are absolute zero (i.e. their effect is entirely removed from the model).</p>
</li>
<li>
<p>Weight decay (a.k.a ridge regression or <code>\(L_2\)</code>) uses a different type of penalty that is most useful for highly correlated predictors.</p>
</li>
</ul>
<p>The glmnet model has two primary tuning parameters, the total amount of penalization and the mixture of the two penalty types. For example, this specification:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_spec <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">linear_reg</span>(penalty <span style="color:#666">=</span> <span style="color:#666">0.1</span>, mixture <span style="color:#666">=</span> <span style="color:#666">0.95</span>) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">set_engine</span>(<span style="color:#ba2121">&#34;glmnet&#34;</span>)
</span></span></code></pre></div><p>has a penalty that is 95% lasso and 5% weight decay. The total amount of these two penalties is 0.1 (which is fairly high).</p>
<div class="note">Models with regularization require that predictors are all on the same scale. The ridership at our three stations are very different, but glmnet <a href="https://parsnip.tidymodels.org/reference/details_linear_reg_glmnet.html">automatically centers and scales the data</a>. You can use recipes to <a href="https://recipes.tidymodels.org/reference/step_normalize.html">center and scale your data yourself</a>.</div>
<p>Let&rsquo;s combine the model specification with a formula in a model <code>workflow()</code> and then fit the model to the data:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_wflow <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">workflow</span>() <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">add_model</span>(glmnet_spec) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">add_formula</span>(ridership <span style="color:#666">~</span> .)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>glmnet_fit <span style="color:#666">&lt;-</span> <span style="color:#00f">fit</span>(glmnet_wflow, Chicago)
</span></span><span style="display:flex;"><span>glmnet_fit
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ══ Workflow [trained] ════════════════════════════════════════════════</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Preprocessor: Formula</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Model: linear_reg()</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ── Preprocessor ──────────────────────────────────────────────────────</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ridership ~ .</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ── Model ─────────────────────────────────────────────────────────────</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = &#34;gaussian&#34;,      alpha = ~0.95) </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    Df %Dev Lambda</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1   0  0.0   6.10</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2   1 12.8   5.56</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3   1 23.4   5.07</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4   1 32.4   4.62</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5   1 40.0   4.21</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 6   1 46.2   3.83</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 7   1 51.5   3.49</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 8   1 55.9   3.18</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 9   1 59.6   2.90</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 10  1 62.7   2.64</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 11  2 65.3   2.41</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 12  2 67.4   2.19</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 13  2 69.2   2.00</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 14  2 70.7   1.82</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 15  2 72.0   1.66</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 16  2 73.0   1.51</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 17  2 73.9   1.38</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 18  2 74.6   1.26</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 19  2 75.2   1.14</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 20  2 75.7   1.04</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 21  2 76.1   0.95</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 22  2 76.4   0.86</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 23  2 76.7   0.79</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 24  2 76.9   0.72</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 25  2 77.1   0.66</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 26  2 77.3   0.60</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 27  2 77.4   0.54</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 28  2 77.6   0.50</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 29  2 77.6   0.45</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 30  2 77.7   0.41</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 31  2 77.8   0.38</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 32  2 77.8   0.34</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 33  2 77.9   0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 34  2 77.9   0.28</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 35  2 78.0   0.26</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 36  2 78.0   0.23</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 37  2 78.0   0.21</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 38  2 78.0   0.20</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 39  2 78.0   0.18</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 40  2 78.0   0.16</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 41  2 78.0   0.15</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 42  2 78.1   0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 43  2 78.1   0.12</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 44  2 78.1   0.11</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 45  2 78.1   0.10</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 46  2 78.1   0.09</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ...</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; and 9 more lines.</span>
</span></span></code></pre></div><p>In this output, the term <code>lambda</code> is used to represent the penalty.</p>
<p>Note that the output shows many values of the penalty despite our specification of <code>penalty = 0.1</code>. It turns out that this model fits a &ldquo;path&rdquo; of penalty values.  Even though we are interested in a value of 0.1, we can get the model coefficients for many associated values of the penalty from the same model object.</p>
<p>Let&rsquo;s look at two different approaches to obtaining the coefficients. Both will use the <code>tidy()</code> method. One will tidy a glmnet object and the other will tidy a tidymodels object.</p>
<h3 id="using-glmnet-penalty-values">Using glmnet penalty values</h3>
<p>This glmnet fit contains multiple penalty values which depend on the data set; changing the data (or the mixture amount) often produces a different set of values. For this data set, there are 55 penalties available. To get the set of penalties produced for this data set, we can extract the engine fit and tidy:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_fit <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">extract_fit_engine</span>() <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">tidy</span>() <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">rename</span>(penalty <span style="color:#666">=</span> lambda) <span style="color:#666">%&gt;%</span>   <span style="color:#408080;font-style:italic"># &lt;- for consistent naming</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">filter</span>(term <span style="color:#666">!=</span> <span style="color:#ba2121">&#34;(Intercept)&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 99 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    term        step estimate penalty dev.ratio</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  1 Clark_Lake     2   0.0753    5.56     0.127</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  2 Clark_Lake     3   0.145     5.07     0.234</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  3 Clark_Lake     4   0.208     4.62     0.324</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  4 Clark_Lake     5   0.266     4.21     0.400</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  5 Clark_Lake     6   0.319     3.83     0.463</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  6 Clark_Lake     7   0.368     3.49     0.515</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  7 Clark_Lake     8   0.413     3.18     0.559</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  8 Clark_Lake     9   0.454     2.90     0.596</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  9 Clark_Lake    10   0.491     2.64     0.627</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 10 Clark_Lake    11   0.526     2.41     0.653</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # … with 89 more rows</span>
</span></span></code></pre></div><p>This works well but, it turns out that our penalty value (0.1) is not in the list produced by the model! The underlying package has functions that use interpolation to produce coefficients for this specific value, but the <code>tidy()</code> method for glmnet objects does not use it.</p>
<h3 id="using-specific-penalty-values">Using specific penalty values</h3>
<p>If we run the <code>tidy()</code> method on the workflow or parsnip object, a different function is used that returns the coefficients for the penalty value that we specified:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">tidy</span>(glmnet_fit)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 4 × 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   term        estimate penalty</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 (Intercept)    1.69      0.1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 Clark_Lake     0.846     0.1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 Austin         0.271     0.1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 Harlem         0         0.1</span>
</span></span></code></pre></div><p>For any another (single) penalty, we can use an additional argument:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">tidy</span>(glmnet_fit, penalty <span style="color:#666">=</span> <span style="color:#666">5.5620</span>)  <span style="color:#408080;font-style:italic"># A value from above</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 4 × 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   term        estimate penalty</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 (Intercept)  12.6       5.56</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 Clark_Lake    0.0753    5.56</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 Austin        0         5.56</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 Harlem        0         5.56</span>
</span></span></code></pre></div><p>The reason for having two <code>tidy()</code> methods is that, with tidymodels, the focus is on using a specific penalty value.</p>
<h3 id="tuning-a-glmnet-model">Tuning a glmnet model</h3>
<p>If we know a priori acceptable values for penalty and mixture, we can use the <code>fit_resamples()</code> function as we did before with linear regression. Otherwise, we can tune those parameters with the tidymodels <code>tune_*()</code> functions.</p>
<p>Let&rsquo;s tune our glmnet model over both parameters with this grid:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>pen_vals <span style="color:#666">&lt;-</span> <span style="color:#666">10</span><span style="color:#00f">^seq</span>(<span style="color:#666">-3</span>, <span style="color:#666">0</span>, length.out <span style="color:#666">=</span> <span style="color:#666">10</span>)
</span></span><span style="display:flex;"><span>grid <span style="color:#666">&lt;-</span> <span style="color:#00f">crossing</span>(penalty <span style="color:#666">=</span> pen_vals, mixture <span style="color:#666">=</span> <span style="color:#00f">c</span>(<span style="color:#666">0.1</span>, <span style="color:#666">1.0</span>))
</span></span></code></pre></div><p>Here is where more glmnet-related complexity comes in: we know that each resample and each value of <code>mixture</code> will probably produce a different set of penalty values contained in the model object. <em>How can we look at the coefficients at the specific penalty values that we are using to tune?</em></p>
<p>The approach that we suggest is to use the special <code>path_values</code> option for glmnet. Details are described in the <a href="https://parsnip.tidymodels.org/reference/glmnet-details.html#arguments">technical documentation about glmnet and tidymodels</a> but in short, this parameter will assign the collection of penalty values used by each glmnet fit (regardless of the data or value of mixture).</p>
<p>We can pass these as an engine argument and then update our previous workflow object:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_tune_spec <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">linear_reg</span>(penalty <span style="color:#666">=</span> <span style="color:#00f">tune</span>(), mixture <span style="color:#666">=</span> <span style="color:#00f">tune</span>()) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">set_engine</span>(<span style="color:#ba2121">&#34;glmnet&#34;</span>, path_values <span style="color:#666">=</span> pen_vals)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>glmnet_wflow <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  glmnet_wflow <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">update_model</span>(glmnet_tune_spec)
</span></span></code></pre></div><p>Now we will use an extraction function similar to when we used ordinary least squares. We add an additional argument to retain coefficients that are shrunk to zero by the lasso penalty:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>get_glmnet_coefs <span style="color:#666">&lt;-</span> <span style="color:#00f">function</span>(x) {
</span></span><span style="display:flex;"><span>  x <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#00f">extract_fit_engine</span>() <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#00f">tidy</span>(return_zeros <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">TRUE</span>) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#00f">rename</span>(penalty <span style="color:#666">=</span> lambda)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>parsnip_ctrl <span style="color:#666">&lt;-</span> <span style="color:#00f">control_grid</span>(extract <span style="color:#666">=</span> get_glmnet_coefs)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>glmnet_res <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  glmnet_wflow <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">tune_grid</span>(
</span></span><span style="display:flex;"><span>    resamples <span style="color:#666">=</span> bt,
</span></span><span style="display:flex;"><span>    grid <span style="color:#666">=</span> grid,
</span></span><span style="display:flex;"><span>    control <span style="color:#666">=</span> parsnip_ctrl
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>glmnet_res
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # Tuning results</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # Bootstrap sampling </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 5 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   splits              id         .metrics          .notes           .extracts</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;list&gt;              &lt;chr&gt;      &lt;list&gt;            &lt;list&gt;           &lt;list&gt;   </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 &lt;split [5698/2076]&gt; Bootstrap1 &lt;tibble [40 × 6]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 &lt;split [5698/2098]&gt; Bootstrap2 &lt;tibble [40 × 6]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 &lt;split [5698/2064]&gt; Bootstrap3 &lt;tibble [40 × 6]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 &lt;split [5698/2082]&gt; Bootstrap4 &lt;tibble [40 × 6]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5 &lt;split [5698/2088]&gt; Bootstrap5 &lt;tibble [40 × 6]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;</span>
</span></span></code></pre></div><p>As noted before, the elements of the main <code>.extracts</code> column have an embedded list column with the results of <code>get_glmnet_coefs()</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_res<span style="color:#666">$</span>.extracts[[1]] <span style="color:#666">%&gt;%</span> <span style="color:#00f">head</span>()
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 6 × 4</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   penalty mixture .extracts         .config              </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;list&gt;            &lt;chr&gt;                </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model01</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model02</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model03</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model04</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model05</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 6       1     0.1 &lt;tibble [40 × 5]&gt; Preprocessor1_Model06</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>glmnet_res<span style="color:#666">$</span>.extracts[[1]]<span style="color:#666">$</span>.extracts[[1]] <span style="color:#666">%&gt;%</span> <span style="color:#00f">head</span>()
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 6 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   term         step estimate penalty dev.ratio</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 (Intercept)     1    0.568  1          0.769</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 (Intercept)     2    0.432  0.464      0.775</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3 (Intercept)     3    0.607  0.215      0.779</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4 (Intercept)     4    0.846  0.1        0.781</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5 (Intercept)     5    1.06   0.0464     0.782</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 6 (Intercept)     6    1.22   0.0215     0.783</span>
</span></span></code></pre></div><p>As before, we&rsquo;ll have to use a double <code>unnest()</code>. Since the penalty value is in both the top-level and lower-level <code>.extracts</code>, we&rsquo;ll use <code>select()</code> to get rid of the first version (but keep <code>mixture</code>):</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_res <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, .extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, mixture, .extracts) <span style="color:#666">%&gt;%</span>  <span style="color:#408080;font-style:italic"># &lt;- removes the first penalty column</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts)
</span></span></code></pre></div><p>But wait! We know that each glmnet fit contains all of the coefficients. This means, for a specific resample and value of <code>mixture</code>, the results are the same:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">all.equal</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#408080;font-style:italic"># First bootstrap, first `mixture`, first `penalty`</span>
</span></span><span style="display:flex;"><span>  glmnet_res<span style="color:#666">$</span>.extracts[[1]]<span style="color:#666">$</span>.extracts[[1]],
</span></span><span style="display:flex;"><span>  <span style="color:#408080;font-style:italic"># First bootstrap, first `mixture`, second `penalty`</span>
</span></span><span style="display:flex;"><span>  glmnet_res<span style="color:#666">$</span>.extracts[[1]]<span style="color:#666">$</span>.extracts[[2]]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; [1] TRUE</span>
</span></span></code></pre></div><p>For this reason, we&rsquo;ll add a <code>slice(1)</code> when grouping by <code>id</code> and <code>mixture</code>. This will get rid of the replicated results.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_coefs <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  glmnet_res <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, .extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, mixture, .extracts) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">group_by</span>(id, mixture) <span style="color:#666">%&gt;%</span>          <span style="color:#408080;font-style:italic"># ┐</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">slice</span>(<span style="color:#666">1</span>) <span style="color:#666">%&gt;%</span>                       <span style="color:#408080;font-style:italic"># │ Remove the redundant results</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">ungroup</span>() <span style="color:#666">%&gt;%</span>                      <span style="color:#408080;font-style:italic"># ┘</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">unnest</span>(.extracts)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>glmnet_coefs <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(id, penalty, mixture, term, estimate) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">filter</span>(term <span style="color:#666">!=</span> <span style="color:#ba2121">&#34;(Intercept)&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 300 × 5</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    id         penalty mixture term       estimate</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  1 Bootstrap1 1           0.1 Clark_Lake    0.391</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  2 Bootstrap1 0.464       0.1 Clark_Lake    0.485</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  3 Bootstrap1 0.215       0.1 Clark_Lake    0.590</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  4 Bootstrap1 0.1         0.1 Clark_Lake    0.680</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  5 Bootstrap1 0.0464      0.1 Clark_Lake    0.746</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  6 Bootstrap1 0.0215      0.1 Clark_Lake    0.793</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  7 Bootstrap1 0.01        0.1 Clark_Lake    0.817</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  8 Bootstrap1 0.00464     0.1 Clark_Lake    0.828</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  9 Bootstrap1 0.00215     0.1 Clark_Lake    0.834</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 10 Bootstrap1 0.001       0.1 Clark_Lake    0.837</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # … with 290 more rows</span>
</span></span></code></pre></div><p>Now we have the coefficients. Let&rsquo;s look at how they behave as more regularization is used:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>glmnet_coefs <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">filter</span>(term <span style="color:#666">!=</span> <span style="color:#ba2121">&#34;(Intercept)&#34;</span>) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">mutate</span>(mixture <span style="color:#666">=</span> <span style="color:#00f">format</span>(mixture)) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">ggplot</span>(<span style="color:#00f">aes</span>(x <span style="color:#666">=</span> penalty, y <span style="color:#666">=</span> estimate, col <span style="color:#666">=</span> mixture, groups <span style="color:#666">=</span> id)) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_hline</span>(yintercept <span style="color:#666">=</span> <span style="color:#666">0</span>, lty <span style="color:#666">=</span> <span style="color:#666">3</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_line</span>(alpha <span style="color:#666">=</span> <span style="color:#666">0.5</span>, lwd <span style="color:#666">=</span> <span style="color:#666">1.2</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">facet_wrap</span>(<span style="color:#666">~</span> term) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">scale_x_log10</span>() <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">scale_color_brewer</span>(palette <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Accent&#34;</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">labs</span>(y <span style="color:#666">=</span> <span style="color:#ba2121">&#34;coefficient&#34;</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">theme</span>(legend.position <span style="color:#666">=</span> <span style="color:#ba2121">&#34;top&#34;</span>)
</span></span></code></pre></div><img src="figs/glmnet-plot-1.svg" width="816" />
<p>Notice a couple of things:</p>
<ul>
<li>
<p>With a pure lasso model (i.e., <code>mixture = 1</code>), the Austin station predictor is selected out in each resample. With a mixture of both penalties, its influence increases. Also, as the penalty increases, the uncertainty in this coefficient decreases.</p>
</li>
<li>
<p>The Harlem predictor is either quickly selected out of the model or goes from negative to positive.</p>
</li>
</ul>
<h2 id="session-information">Session information</h2>
<pre tabindex="0"><code>#&gt; ─ Session info ─────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.1.2 (2021-11-01)
#&gt;  os       macOS Monterey 12.3.1
#&gt;  system   aarch64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_US.UTF-8
#&gt;  ctype    en_US.UTF-8
#&gt;  tz       America/New_York
#&gt;  date     2022-06-20
#&gt;  pandoc   2.17.1.1 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ─────────────────────────────────────────────────────────
#&gt;  package    * version date (UTC) lib source
#&gt;  broom      * 0.8.0   2022-04-13 [1] CRAN (R 4.1.1)
#&gt;  dials      * 1.0.0   2022-06-14 [1] CRAN (R 4.1.2)
#&gt;  dplyr      * 1.0.9   2022-04-28 [1] CRAN (R 4.1.1)
#&gt;  ggplot2    * 3.3.6   2022-05-03 [1] CRAN (R 4.1.1)
#&gt;  glmnet     * 4.1-4   2022-04-15 [1] CRAN (R 4.1.1)
#&gt;  infer      * 1.0.0   2021-08-13 [1] CRAN (R 4.1.1)
#&gt;  parsnip    * 1.0.0   2022-06-16 [1] CRAN (R 4.1.2)
#&gt;  purrr      * 0.3.4   2020-04-17 [1] CRAN (R 4.1.0)
#&gt;  recipes    * 0.2.0   2022-02-18 [1] CRAN (R 4.1.1)
#&gt;  rlang        1.0.2   2022-03-04 [1] CRAN (R 4.1.2)
#&gt;  rsample    * 0.1.1   2021-11-08 [1] CRAN (R 4.1.2)
#&gt;  tibble     * 3.1.7   2022-05-03 [1] CRAN (R 4.1.1)
#&gt;  tidymodels * 0.2.0   2022-03-19 [1] CRAN (R 4.1.2)
#&gt;  tune       * 0.2.0   2022-03-19 [1] CRAN (R 4.1.2)
#&gt;  workflows  * 0.2.6   2022-03-18 [1] CRAN (R 4.1.1)
#&gt;  yardstick  * 0.0.9   2021-11-22 [1] CRAN (R 4.1.1)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library
#&gt; 
#&gt; ────────────────────────────────────────────────────────────────────
</code></pre>
      </div>


      <div class="article-footer">
      
      <div style="float:left">
      
        <div class='itemTitle' align="left" style='font-size:.8em; line-height:2em'>Previous</div>
        <a href="/learn/models/time-series/">Modeling time series with tidy resampling</a>
      
      </div>
      
      
      <div style="float:right">
      
      <div class='itemTitle' align="right" style='font-size:.8em; line-height:2em'>Next</div>
        <a href="/learn/models/pls/">Multivariate analysis using partial least squares</a>
      
      </div>
     </div> 

      </div>

      <div class="column25">
        <div class="section hideOnMobile">
          <div class="sectionTitle">Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#linear-regression">Linear regression</a></li>
    <li><a href="#more-complex-a-glmnet-model">More complex: a glmnet model</a></li>
    <li><a href="#session-information">Session information</a></li>
  </ul>
</nav>
        </div>
      
        <div class="section">
          <div class="sectionTitle">Resources</div>
          




<div class="event">
  
  <div class="eventTitle">
    <a href="/find/"><i class="fas fa-search fa-xs"></i>&nbsp;&nbsp;Find</a>
  </div>
  <div class="eventDetails">Explore searchable tables of all tidymodels packages and functions.</div>
</div>






<div class="event">
  
  <div class="eventTitle">
    <a href="/books/"><i class="fas fa-book-open fa-xs"></i>&nbsp;&nbsp;Books</a>
  </div>
  <div class="eventDetails">Study up on statistics and modeling with our comprehensive books.</div>
</div>






<div class="event">
  
  <div class="eventTitle">
    <a href="https://www.tidyverse.org/tags/tidymodels/" target="_blank"><i class="fas fa-bullhorn fa-xs"></i>&nbsp;&nbsp;News</a>
  </div>
  <div class="eventDetails">Hear the latest about tidymodels packages at the <a href="https://www.tidyverse.org/tags/tidymodels/">tidyverse blog</a>.</div>
</div>



        </div>
      </div>
      


    </div>
  </div>  
</div> 


        <div id="rStudioFooter" class="band">
          <div class="bandContent">
            <div id="copyright">
              
              
              Proudly supported by <a class="rstudioLogo" href="https://www.rstudio.com/"></a>
              
            </div>
            <div id="logos">
              
              
            </div>
            
            <span class="float-right" aria-hidden="true">
              <a href="#" class="back-to-top">
                <span class="button_icon">
                  <i class="fas fa-chevron-up fa-2x"></i>
                </span>
              </a>
            </span>
            
          </div>
        </div>

      </div>  
    </div>  

    

    
<script src="/js/math-code.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-20375833-29', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

</body>
</html>
