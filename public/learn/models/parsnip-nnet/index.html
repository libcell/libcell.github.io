<!DOCTYPE html>
<html>
<head>
<!DOCTYPE html>
<html lang="en-us">



<link rel="stylesheet" href="/css/fonts.css">
<link rel="stylesheet" href="/css/main-site.css">
<link rel="stylesheet" href="/css/fa5-all.css">
<style type="text/css">
    body {
	background-color: #ffffff;
	color: #404040
}

/* Links */

a {
  color: #CA225E;
}

a:hover {
  color: #cc3168;
}

/* Landing page content bands */

#homeContent .band.first {
  background-color: #ffffff
}

#homeContent .band.second {
  background-color: #fcfcfc
}

#homeContent .band.third {
  background-color: #ffffff
}

/* Top navigation bar menu */

#rStudioHeader {
  background-color: #ffffff;
  color: black;
}

#rStudioHeader .productName {
  color: #CA225E
}

#rStudioHeader .productName:hover {
  color: #00000075
}

#rStudioHeader #menu .menuItem.a {
  background-color: #75aadb;
  color: black;
}

#rStudioHeader #menu .menuItem:hover {
  background-color: white;
  color: #CA225E;
}

#rStudioHeader #menu .menuItem.current {
  background-color: #fcfcfc;
  color: #CA225E;
  text-decoration: none;
}

/* Footer */

#rStudioFooter.band {
  background-color: #CA225E40;
}

#rStudioFooter .bandContent #copyright {
  color: #CA225E;
}

/* Tables */

table tbody tr:nth-child(even){
  background-color: #fcfcfc;
}

table tbody tr:nth-child(odd){
  background-color: #1a162d10;
}

.latest {
  border-top: .5em solid <no value>;
}
</style>

  <link rel="stylesheet" href="/css/tm.css">




<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="apple-mobile-web-app-capable" content="yes" />

<meta name="og:image" content="https://www.tidymodels.org/images/feature_summary_large_image.jpg" >

  <meta property="twitter:card" content="summary_large_image">

<meta name="twitter:image" content="https://www.tidymodels.org/images/feature_summary_large_image.jpg" ><meta name="generator" content="Hugo 0.96.0" />

<meta property="og:type" content="website"><title>Learn - Classification models using a neural network</title>
    <meta property="og:title" content="Learn - Classification models using a neural network">
    
    
    
    
    <meta property="description" content="Train a classification model and evaluate its performance.
">
    <meta property="og:description" content="Train a classification model and evaluate its performance.
">



<link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png" />
<link rel="manifest" href="/images/favicons/site.webmanifest" />
<link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" />
<link rel="shortcut icon" href="/images/favicons/favicon.ico" />
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" href="/images/favicons/browserconfig.xml" >



<script type="text/javascript" src="/js/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="/js/site.js"></script>


  <script type="text/javascript" src="/js/tm.js"></script>


<link rel="icon" href="/images/favicon.ico" />


<script defer data-domain="tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>



  <body>
    <div id="appTidyverseSite" class="shrinkHeader alwaysShrinkHeader">
      <div id="main">
        
        <div id="rStudioHeader">
          <div class="band">
            <div class="innards bandContent">
              <div>
                <a class="productName" href="/">Tidymodels</a>
                
              </div>
              <div id="menu">
  <div id="menuToggler"></div>
  <div id="menuItems" class="">
    
    
      
      
      
    <a class="menuItem " href="/packages/">Packages</a>
    
      
      
      
    <a class="menuItem " href="/start/">Get Started</a>
    
      
      
      
    <a class="menuItem current" href="/learn/">Learn</a>
    
      
      
      
    <a class="menuItem " href="/help/">Help</a>
    
      
      
      
    <a class="menuItem " href="/contribute/">Contribute</a>
    
      
      
      
    <a class="menuItem " href="/find/"><i class="fas fa-search fa-lg"></i> </a>
    
      
      
      
    <a class="menuItem " href="https://github.com/tidymodels/"><i class="fab fa-github fa-lg"></i></a>
    
  </div>
</div>

            </div>
          </div>
        </div>
</head>
<body>


 




<div class="band padForHeader pushFooter">
  <div class="bandContent">
    <div class="full splitColumns withMobileMargins">
      <div class="column75">
        
        <div class="section">
          <div class="sectionTitle">
            <a href="/learn/">
              <i class="fas fa-chevron-left"></i>&nbsp;Back to Learn
            </a>
          </div>
        </div>

      <h1 class="article-title">Classification models using a neural network</h1>

      
      <div class="article-header">
        </div>
        

      
      
      
      
        </p>
      
        
      <div class="learning-objective-container">
        <h2 class="learning-objective">Learning objective</h2>
        <p class="single-learning-objective-text">Train a classification model and evaluate its performance.</p>
      </div>
      

      <div class="article-content">
      <h2 id="introduction">Introduction</h2>
<p>To use the code in this article, you will need to install the following packages: keras and tidymodels. You will also need the python keras library installed (see <code>?keras::install_keras()</code>).</p>
<p>We can create classification models with the tidymodels package <a href="https://parsnip.tidymodels.org/">parsnip</a> to predict categorical quantities or class labels. Here, let&rsquo;s fit a single classification model using a neural network and evaluate using a validation set. While the <a href="https://tune.tidymodels.org/">tune</a> package has functionality to also do this, the parsnip package is the center of attention in this article so that we can better understand its usage.</p>
<h2 id="fitting-a-neural-network">Fitting a neural network</h2>
<p>Let&rsquo;s fit a model to a small, two predictor classification data set. The data are in the modeldata package (part of tidymodels) and have been split into training, validation, and test data sets. In this analysis, the test set is left untouched; this article tries to emulate a good data usage methodology where the test set would only be evaluated once at the end after a variety of models have been considered.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">data</span>(bivariate)
</span></span><span style="display:flex;"><span><span style="color:#00f">nrow</span>(bivariate_train)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; [1] 1009</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">nrow</span>(bivariate_val)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; [1] 300</span>
</span></span></code></pre></div><p>A plot of the data shows two right-skewed predictors:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">ggplot</span>(bivariate_train, <span style="color:#00f">aes</span>(x <span style="color:#666">=</span> A, y <span style="color:#666">=</span> B, col <span style="color:#666">=</span> Class)) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_point</span>(alpha <span style="color:#666">=</span> <span style="color:#666">.2</span>)
</span></span></code></pre></div><img src="figs/biv-plot-1.svg" width="576" />
<p>Let&rsquo;s use a single hidden layer neural network to predict the outcome. To do this, we transform the predictor columns to be more symmetric (via the <code>step_BoxCox()</code> function) and on a common scale (using <code>step_normalize()</code>). We can use <a href="https://recipes.tidymodels.org/">recipes</a> to do so:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>biv_rec <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">recipe</span>(Class <span style="color:#666">~</span> ., data <span style="color:#666">=</span> bivariate_train) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">step_BoxCox</span>(<span style="color:#00f">all_predictors</span>())<span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">step_normalize</span>(<span style="color:#00f">all_predictors</span>()) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">prep</span>(training <span style="color:#666">=</span> bivariate_train, retain <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># We will bake(new_data = NULL) to get the processed training set back</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># For validation:</span>
</span></span><span style="display:flex;"><span>val_normalized <span style="color:#666">&lt;-</span> <span style="color:#00f">bake</span>(biv_rec, new_data <span style="color:#666">=</span> bivariate_val, <span style="color:#00f">all_predictors</span>())
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># For testing when we arrive at a final model: </span>
</span></span><span style="display:flex;"><span>test_normalized <span style="color:#666">&lt;-</span> <span style="color:#00f">bake</span>(biv_rec, new_data <span style="color:#666">=</span> bivariate_test, <span style="color:#00f">all_predictors</span>())
</span></span></code></pre></div><p>We can use the keras package to fit a model with 5 hidden units and a 10% dropout rate, to regularize the model:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">set.seed</span>(<span style="color:#666">57974</span>)
</span></span><span style="display:flex;"><span>nnet_fit <span style="color:#666">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">mlp</span>(epochs <span style="color:#666">=</span> <span style="color:#666">100</span>, hidden_units <span style="color:#666">=</span> <span style="color:#666">5</span>, dropout <span style="color:#666">=</span> <span style="color:#666">0.1</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">set_mode</span>(<span style="color:#ba2121">&#34;classification&#34;</span>) <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#408080;font-style:italic"># Also set engine-specific `verbose` argument to prevent logging the results: </span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">set_engine</span>(<span style="color:#ba2121">&#34;keras&#34;</span>, verbose <span style="color:#666">=</span> <span style="color:#666">0</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">fit</span>(Class <span style="color:#666">~</span> ., data <span style="color:#666">=</span> <span style="color:#00f">bake</span>(biv_rec, new_data <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">NULL</span>))
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Loaded Tensorflow version 2.6.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nnet_fit
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; parsnip model object</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Model: &#34;sequential&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ________________________________________________________________________________</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Layer (type)                        Output Shape                    Param #     </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ================================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; dense (Dense)                       (None, 5)                       15          </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ________________________________________________________________________________</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; dense_1 (Dense)                     (None, 5)                       30          </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ________________________________________________________________________________</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; dropout (Dropout)                   (None, 5)                       0           </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ________________________________________________________________________________</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; dense_2 (Dense)                     (None, 2)                       12          </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ================================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Total params: 57</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Trainable params: 57</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Non-trainable params: 0</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; ________________________________________________________________________________</span>
</span></span></code></pre></div><h2 id="model-performance">Model performance</h2>
<p>In parsnip, the <code>predict()</code> function can be used to characterize performance on the validation set. Since parsnip always produces tibble outputs, these can just be column bound to the original data:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>val_results <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  bivariate_val <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">bind_cols</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#00f">predict</span>(nnet_fit, new_data <span style="color:#666">=</span> val_normalized),
</span></span><span style="display:flex;"><span>    <span style="color:#00f">predict</span>(nnet_fit, new_data <span style="color:#666">=</span> val_normalized, type <span style="color:#666">=</span> <span style="color:#ba2121">&#34;prob&#34;</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>val_results <span style="color:#666">%&gt;%</span> <span style="color:#00f">slice</span>(<span style="color:#666">1</span><span style="color:#666">:</span><span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 5 × 6</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;       A     B Class .pred_class .pred_One .pred_Two</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 1061.  74.5 One   Two             0.444    0.556 </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 2 1241.  83.4 One   Two             0.464    0.536 </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 3  939.  71.9 One   One             0.778    0.222 </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 4  813.  77.1 One   One             0.988    0.0123</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 5 1706.  92.8 Two   Two             0.231    0.769</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>val_results <span style="color:#666">%&gt;%</span> <span style="color:#00f">roc_auc</span>(truth <span style="color:#666">=</span> Class, .pred_One)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 × 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   .metric .estimator .estimate</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 roc_auc binary         0.815</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>val_results <span style="color:#666">%&gt;%</span> <span style="color:#00f">accuracy</span>(truth <span style="color:#666">=</span> Class, .pred_class)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 × 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   .metric  .estimator .estimate</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 accuracy binary         0.733</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>val_results <span style="color:#666">%&gt;%</span> <span style="color:#00f">conf_mat</span>(truth <span style="color:#666">=</span> Class, .pred_class)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;           Truth</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; Prediction One Two</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;        One 150  28</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;        Two  52  70</span>
</span></span></code></pre></div><p>Let&rsquo;s also create a grid to get a visual sense of the class boundary for the validation set.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>a_rng <span style="color:#666">&lt;-</span> <span style="color:#00f">range</span>(bivariate_train<span style="color:#666">$</span>A)
</span></span><span style="display:flex;"><span>b_rng <span style="color:#666">&lt;-</span> <span style="color:#00f">range</span>(bivariate_train<span style="color:#666">$</span>B)
</span></span><span style="display:flex;"><span>x_grid <span style="color:#666">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">expand.grid</span>(A <span style="color:#666">=</span> <span style="color:#00f">seq</span>(a_rng[1], a_rng[2], length.out <span style="color:#666">=</span> <span style="color:#666">100</span>),
</span></span><span style="display:flex;"><span>              B <span style="color:#666">=</span> <span style="color:#00f">seq</span>(b_rng[1], b_rng[2], length.out <span style="color:#666">=</span> <span style="color:#666">100</span>))
</span></span><span style="display:flex;"><span>x_grid_trans <span style="color:#666">&lt;-</span> <span style="color:#00f">bake</span>(biv_rec, x_grid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Make predictions using the transformed predictors but </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># attach them to the predictors in the original units: </span>
</span></span><span style="display:flex;"><span>x_grid <span style="color:#666">&lt;-</span> 
</span></span><span style="display:flex;"><span>  x_grid <span style="color:#666">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">bind_cols</span>(<span style="color:#00f">predict</span>(nnet_fit, x_grid_trans, type <span style="color:#666">=</span> <span style="color:#ba2121">&#34;prob&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">ggplot</span>(x_grid, <span style="color:#00f">aes</span>(x <span style="color:#666">=</span> A, y <span style="color:#666">=</span> B)) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_contour</span>(<span style="color:#00f">aes</span>(z <span style="color:#666">=</span> .pred_One), breaks <span style="color:#666">=</span> <span style="color:#666">.5</span>, col <span style="color:#666">=</span> <span style="color:#ba2121">&#34;black&#34;</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">geom_point</span>(data <span style="color:#666">=</span> bivariate_val, <span style="color:#00f">aes</span>(col <span style="color:#666">=</span> Class), alpha <span style="color:#666">=</span> <span style="color:#666">0.3</span>)
</span></span></code></pre></div><img src="figs/biv-boundary-1.svg" width="576" />
<h2 id="session-information">Session information</h2>
<pre tabindex="0"><code>#&gt; ─ Session info ─────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.1.2 (2021-11-01)
#&gt;  os       macOS Monterey 12.3
#&gt;  system   aarch64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_GB.UTF-8
#&gt;  ctype    en_GB.UTF-8
#&gt;  tz       Europe/London
#&gt;  date     2022-04-11
#&gt;  pandoc   2.14.0.3 @ /Applications/RStudio.app/Contents/MacOS/pandoc/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ─────────────────────────────────────────────────────────
#&gt;  package    * version date (UTC) lib source
#&gt;  broom      * 0.7.12  2022-01-28 [1] CRAN (R 4.1.1)
#&gt;  dials      * 0.1.1   2022-04-06 [1] CRAN (R 4.1.2)
#&gt;  dplyr      * 1.0.8   2022-02-08 [1] CRAN (R 4.1.2)
#&gt;  ggplot2    * 3.3.5   2021-06-25 [1] CRAN (R 4.1.1)
#&gt;  infer      * 1.0.0   2021-08-13 [1] CRAN (R 4.1.1)
#&gt;  keras        2.8.0   2022-02-10 [1] CRAN (R 4.1.1)
#&gt;  parsnip    * 0.2.1   2022-03-17 [1] CRAN (R 4.1.1)
#&gt;  purrr      * 0.3.4   2020-04-17 [1] CRAN (R 4.1.0)
#&gt;  recipes    * 0.2.0   2022-02-18 [1] CRAN (R 4.1.1)
#&gt;  rlang        1.0.2   2022-03-04 [1] CRAN (R 4.1.1)
#&gt;  rsample    * 0.1.1   2021-11-08 [1] CRAN (R 4.1.2)
#&gt;  tibble     * 3.1.6   2021-11-07 [1] CRAN (R 4.1.1)
#&gt;  tidymodels * 0.2.0   2022-03-19 [1] CRAN (R 4.1.1)
#&gt;  tune       * 0.2.0   2022-03-19 [1] CRAN (R 4.1.2)
#&gt;  workflows  * 0.2.6   2022-03-18 [1] CRAN (R 4.1.2)
#&gt;  yardstick  * 0.0.9   2021-11-22 [1] CRAN (R 4.1.1)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library
#&gt; 
#&gt; ─ Python configuration ─────────────────────────────────────────────
#&gt;  python:         /opt/homebrew/Caskroom/miniforge/base/envs/tf_env/bin/python
#&gt;  libpython:      /opt/homebrew/Caskroom/miniforge/base/envs/tf_env/lib/libpython3.9.dylib
#&gt;  pythonhome:     /opt/homebrew/Caskroom/miniforge/base/envs/tf_env:/opt/homebrew/Caskroom/miniforge/base/envs/tf_env
#&gt;  version:        3.9.7 | packaged by conda-forge | (default, Sep 29 2021, 19:24:02)  [Clang 11.1.0 ]
#&gt;  numpy:          /opt/homebrew/Caskroom/miniforge/base/envs/tf_env/lib/python3.9/site-packages/numpy
#&gt;  numpy_version:  1.19.5
#&gt;  tensorflow:     /opt/homebrew/Caskroom/miniforge/base/envs/tf_env/lib/python3.9/site-packages/tensorflow
#&gt;  
#&gt;  NOTE: Python version was forced by RETICULATE_PYTHON
#&gt; 
#&gt; ────────────────────────────────────────────────────────────────────
</code></pre>
      </div>


      <div class="article-footer">
      
      <div style="float:left">
      
        <div class='itemTitle' align="left" style='font-size:.8em; line-height:2em'>Previous</div>
        <a href="/learn/models/parsnip-ranger-glmnet/">Regression models two ways</a>
      
      </div>
      
      
      <div style="float:right">
      
      <div class='itemTitle' align="right" style='font-size:.8em; line-height:2em'>Next</div>
        <a href="/learn/models/sub-sampling/">Subsampling for class imbalances</a>
      
      </div>
     </div> 

      </div>

      <div class="column25">
        <div class="section hideOnMobile">
          <div class="sectionTitle">Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#fitting-a-neural-network">Fitting a neural network</a></li>
    <li><a href="#model-performance">Model performance</a></li>
    <li><a href="#session-information">Session information</a></li>
  </ul>
</nav>
        </div>
      
        <div class="section">
          <div class="sectionTitle">Resources</div>
          




<div class="event">
  
  <div class="eventTitle">
    <a href="/find/"><i class="fas fa-search fa-xs"></i>&nbsp;&nbsp;Find</a>
  </div>
  <div class="eventDetails">Explore searchable tables of all tidymodels packages and functions.</div>
</div>






<div class="event">
  
  <div class="eventTitle">
    <a href="/books/"><i class="fas fa-book-open fa-xs"></i>&nbsp;&nbsp;Books</a>
  </div>
  <div class="eventDetails">Study up on statistics and modeling with our comprehensive books.</div>
</div>






<div class="event">
  
  <div class="eventTitle">
    <a href="https://www.tidyverse.org/tags/tidymodels/" target="_blank"><i class="fas fa-bullhorn fa-xs"></i>&nbsp;&nbsp;News</a>
  </div>
  <div class="eventDetails">Hear the latest about tidymodels packages at the <a href="https://www.tidyverse.org/tags/tidymodels/">tidyverse blog</a>.</div>
</div>



        </div>
      </div>
      


    </div>
  </div>  
</div> 


        <div id="rStudioFooter" class="band">
          <div class="bandContent">
            <div id="copyright">
              
              
              Proudly supported by <a class="rstudioLogo" href="https://www.rstudio.com/"></a>
              
            </div>
            <div id="logos">
              
              
            </div>
            
            <span class="float-right" aria-hidden="true">
              <a href="#" class="back-to-top">
                <span class="button_icon">
                  <i class="fas fa-chevron-up fa-2x"></i>
                </span>
              </a>
            </span>
            
          </div>
        </div>

      </div>  
    </div>  

    

    
<script src="/js/math-code.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-20375833-29', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

</body>
</html>
